<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ü–¶–† –¥–∞–Ω–Ω—ã—Ö —Å –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–æ–π</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß¨</text></svg>">
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- –ü–ª–∞–≥–∏–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ZIP –∞—Ä—Ö–∏–≤–æ–≤ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="title">üß¨ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ü–¶–† –¥–∞–Ω–Ω—ã—Ö —Å –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–æ–π</h1>
            <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel-—Ñ–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ü–¶–† –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
        </header>

        <main class="main-content">
            <section class="info-section">
                <div class="info-card">
                    <h3>üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</h3>
                    <ul class="feature-list">
                        <li><strong>–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</strong> –ø–æ Target (–≥–µ–Ω–∞–º)</li>
                        <li><strong>–†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π</strong> Cq</li>
                        <li><strong>–ù–æ—Ä–º–∏—Ä–æ–≤–∫–∞</strong> –ø–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–º—É –≥–µ–Ω—É (—Ñ–æ—Ä–º—É–ª–∞: 2^(-ŒîCq))</li>
                        <li><strong>–≠–∫—Å–ø–æ—Ä—Ç</strong> –≤ Excel –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç</li>
                        <li><strong>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</strong> —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π</li>
                    </ul>
                </div>

                <div class="note-card">
                    <h3>‚ö†Ô∏è –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <p>–§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏ <strong>Target</strong>, <strong>Sample</strong> –∏ <strong>Cq</strong> –Ω–∞—á–∏–Ω–∞—è —Å 27 —Å—Ç—Ä–æ–∫–∏.</p>
                    <p>–§–æ—Ä–º–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π Cq: —á–∏—Å–ª–∞ —Å —Ç–æ—á–∫–æ–π –∏–ª–∏ –∑–∞–ø—è—Ç–æ–π –∫–∞–∫ –¥–µ—Å—è—Ç–∏—á–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º.</p>
                </div>
            </section>

            <section class="upload-section">
                <div class="upload-card">
                    <h2>üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞</h2>
                    <div class="file-input-container">
                        <label for="excelFile" class="file-label">
                            <span class="file-icon">üìÑ</span>
                            <span class="file-text">–í—ã–±–µ—Ä–∏—Ç–µ Excel –∏–ª–∏ CSV —Ñ–∞–π–ª</span>
                            <input type="file" id="excelFile" accept=".xlsx, .xls, .csv" class="file-input">
                        </label>
                        <div class="file-info" id="fileInfo"></div>
                    </div>
                    <button id="analyzeBtn" class="btn btn-primary btn-large">
                        <span class="btn-icon">üî¨</span>
                        –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
                    </button>
                </div>
            </section>

            <section class="normalization-section">
                <div class="normalization-card">
                    <h2>üß™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏</h2>
                    <div class="normalization-controls">
                        <div class="input-group">
                            <label for="normalizationGene" class="input-label">–ì–µ–Ω –¥–ª—è –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏:</label>
                            <input type="text" id="normalizationGene" value="36b4" 
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–µ–Ω–∞" class="text-input">
                            <div class="input-hint">–ù–∞–ø—Ä–∏–º–µ—Ä: 36b4, ACTB, GAPDH</div>
                        </div>
                        <button id="updateNormBtn" class="btn btn-secondary">
                            <span class="btn-icon">üîÑ</span>
                            –û–±–Ω–æ–≤–∏—Ç—å –Ω–æ—Ä–º–∏—Ä–æ–≤–∫—É
                        </button>
                    </div>
                    <div class="formula-info">
                        <strong>–§–æ—Ä–º—É–ª–∞ –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏:</strong> 2<sup>(-ŒîCq)</sup>, –≥–¥–µ ŒîCq = Cq<sub>–≥–µ–Ω–∞</sub> - Cq<sub>–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–≥–æ –≥–µ–Ω–∞</sub>
                    </div>
                </div>
            </section>

            <section id="resultsSection" class="results-section" style="display: none;">
                <div class="results-header">
                    <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h2>
                    <div class="controls" id="resultsControls">
                        <button id="exportBtn" class="btn btn-export">
                            <span class="btn-icon">üìä</span>
                            –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                        </button>
                        <button id="exportNormBtn" class="btn btn-export">
                            <span class="btn-icon">üìà</span>
                            –≠–∫—Å–ø–æ—Ä—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏
                        </button>
                        <button id="copyBtn" class="btn btn-secondary">
                            <span class="btn-icon">üìã</span>
                            –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç
                        </button>
                        <button id="resetBtn" class="btn btn-reset">
                            <span class="btn-icon">üîÑ</span>
                            –ù–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
                        </button>
                    </div>
                </div>

                <div class="tabs">
                    <div class="tab-buttons">
                        <button id="meanTabBtn" class="tab-btn active" data-tab="mean">
                            <span class="tab-icon">üìà</span>
                            –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è Cq
                        </button>
                        <button id="normTabBtn" class="tab-btn" data-tab="norm">
                            <span class="tab-icon">üß¨</span>
                            –ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                        </button>
                    </div>
                    
                    <div class="tab-content">
                        <div id="meanTab" class="tab-pane active">
                            <div id="meanTable"></div>
                        </div>
                        <div id="normTab" class="tab-pane">
                            <div id="normTable"></div>
                        </div>
                    </div>
                </div>

                <div class="legend">
                    <h4>üìù –õ–µ–≥–µ–Ω–¥–∞:</h4>
                    <div class="legend-items">
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #27ae60;"></span>
                            <span>–ì–µ–Ω –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #c0392b;"></span>
                            <span>NTC (–∫–æ–Ω—Ç—Ä–æ–ª—å –±–µ–∑ –º–∞—Ç—Ä–∏—Ü—ã)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #ffeaa7;"></span>
                            <span>UNDETERMINED (–∑–Ω–∞—á–µ–Ω–∏–µ = 0)</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #e8f4f8;"></span>
                            <span>–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Cq</span>
                        </div>
                    </div>
                </div>

                <div id="textOutput" class="text-output"></div>
            </section>

            <section class="help-section">
                <div class="help-card">
                    <h3>‚ùì –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>
                    <ol class="steps-list">
                        <li><strong>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª</strong> —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ü–¶–†</li>
                        <li><strong>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</strong> –Ω–∞—Ö–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞—á–∏–Ω–∞—è —Å 27 —Å—Ç—Ä–æ–∫–∏</li>
                        <li><strong>–î–∞–Ω–Ω—ã–µ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è</strong> –ø–æ Target (–≥–µ–Ω–∞–º)</li>
                        <li><strong>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–µ–Ω–∞</strong> –≤—ã–≤–æ–¥—è—Ç—Å—è –≤—Å–µ Sample (–æ–±—Ä–∞–∑—Ü—ã)</li>
                        <li><strong>–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ</strong> –∑–Ω–∞—á–µ–Ω–∏–µ Cq –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–Ω–æ—Å—Ç—è–º–∏</li>
                        <li><strong>–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∞</strong> –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–º—É –≥–µ–Ω—É</li>
                        <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–∂–Ω–æ</strong> —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</li>
                    </ol>
                </div>
            </section>
            <section id="chartsSection" class="charts-section">
            <div class="charts-header">
                <h2>üìä –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>
                <div class="chart-controls">
                    <div class="input-group">
                        <label for="excludeSamples" class="input-label">
                            –ò—Å–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–∑—Ü—ã –∏–∑ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):
                        </label>
                        <input type="text" id="excludeSamples" 
                            placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: NTC, Control, Blank" 
                            class="text-input" style="width: 100%;">
                        <div class="input-hint">–≠—Ç–∏ –æ–±—Ä–∞–∑—Ü—ã –Ω–µ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö</div>
                    </div>
                    
                    <div class="chart-actions">
                        <button id="generateChartsBtn" class="btn btn-primary">
                            <span class="btn-icon">üìà</span>
                            –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏
                        </button>
                        <button id="downloadAllChartsBtn" class="btn btn-export">
                            <span class="btn-icon">üñºÔ∏è</span>
                            –°–∫–∞—á–∞—Ç—å –≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏
                        </button>
                        <button id="exportChartsDataBtn" class="btn btn-secondary">
                            <span class="btn-icon">üìä</span>
                            –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="charts-filters">
                <div class="filter-group">
                    <label class="filter-label">–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞:</label>
                    <select id="colorScheme" class="select-input">
                        <option value="category10">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è</option>
                        <option value="set1">–Ø—Ä–∫–∞—è</option>
                        <option value="set2">–ü–∞—Å—Ç–µ–ª—å–Ω–∞—è</option>
                        <option value="set3">–†–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω–∞—è</option>
                        <option value="tableau10">Tableau</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è:</label>
                    <select id="chartOrientation" class="select-input">
                        <option value="vertical">–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è</option>
                        <option value="horizontal">–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="showValues" checked>
                        –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö
                    </label>
                </div>
                
                <div class="filter-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="sortByValue" checked>
                        –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
                    </label>
                </div>
            </div>
            
            <div class="charts-container" id="chartsContainer">
                <!-- –ì—Ä–∞—Ñ–∏–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>
            
            <div class="charts-legend">
                <h4>üìù –ü–æ–¥—Å–∫–∞–∑–∫–∏:</h4>
                <ul>
                    <li>–ì—Ä–∞—Ñ–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Target</li>
                    <li>–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –≥–µ–Ω –Ω–æ—Ä–º–∏—Ä–æ–≤–∫–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö</li>
                    <li>–û–±—Ä–∞–∑—Ü—ã, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –ø–æ–ª–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –±—É–¥—É—Ç —Å–∫—Ä—ã—Ç—ã</li>
                    <li>–ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ</li>
                    <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤ PNG —Ñ–æ—Ä–º–∞—Ç–µ</li>
                </ul>
            </div>
        </section>
        </main>

        <footer class="footer">
            <p>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ü–¶–† –¥–∞–Ω–Ω—ã—Ö | –î–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</p>
            <p class="footer-note">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: .xlsx, .xls, .csv</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>